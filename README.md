# final-project-whartwig
This project processes and outputs data used to create municipal financial analysis and interactive maps via Streamlit Community Cloud with a focus on the potential reabsorption of St. Louis into St. Louis County.

Streamlit Community Cloud Link: [[Insert Link Here](https://final-project-wyatt-angqqwcv8dvhrurxs3ls7x.streamlit.app/)]



## Setup
It is highly recommended to use the provided `environment.yml` to ensure all spatial and dashboard dependencies are met:
```bash
conda env create -f environment.yml
conda activate stl_analysis
```



## Structure
- `data/`
  - `raw-data/`: Raw datasets for analysis and mapping.
    - `muni_finances_merged.csv`: St. Louis area municipal finances.
    - `muni_governance_merged.csv`: St. Louis area municipal governance data.
    - `stl_innovation_geo.csv`: St. Louis area economic clusters.
    - `police.geojson`: Police station locations.
    - `stl_firestat.geojson`: St. Louis City fire stations.
    - `stlc_firedist.geojson`: St. Louis County fire districts.
    - `stations_bus.geojson`: St. Louis area bus stations.
    - `stations_metro.geojson`: MetroLink stations.
    - `routes_bus.geojson`: Area bus routes.
    - `routes_metro.geojson`: MetroLink tracks.
    - `fisc_data.csv`: Lincoln Institute Fiscally Standardized City (FiSC) data.
    - `census_tracts.shp/.dbf/.shx`: Regional census tract shapefiles.
    - `Municipal_Boundaries.geojson`: St. Louis area municipality borders.
  - `derived-data/`: Processed outputs generated by the scripts.
    - `stl_econ.geojson`: Geospatial conversion of innovation clusters.
    - `busroute.geojson`, `metroroute.geojson`: Processed transit routes.
    - `metrostat.geojson`, `busstat.geojson`: Processed transit stations.
    - `firedist.geojson`, `firestat.geojson`, `police.geojson`: Cleaned safety infrastructure.
    - `munis_merged.geojson`: Combined municipal finance and boundary data.
    - `all_tracts.geojson`: Regional census tracts with demographic attributes.
    - `newstl_dis.geojson`: Proposed "New St. Louis" boundary (dissolved).
    - `newstl_tracts.geojson`: Census tracts comprising the proposed new city.
    - `stl_tracts.geojson`: Census tracts for the current city boundary.
- `code/`
  - `preprocessing.py`: Data cleaning, Census API integration, and geospatial processing.
  - `fisc_plots.py`: Financial analysis and visualization generation (4 plots).
- `streamlit-app/`
  - `app.py`: Source code for the interactive Streamlit dashboard.
  - `requierments.txt`: Requierments for streamlit to bypass .yml for efficient deployment (C errors)
- `environment.yml`: Comprehensive Conda environment configuration.



## Usage
1. **Data Preprocessing:**
   Generate the processed datasets (Note: Requires a Census API key in `code/preprocessing.py`).
   ```bash
   python code/preprocessing.py
   ```
2. **Generate Visualizations:**
   Create the static financial comparison and regression plots.
   ```bash
   python code/fisc_plots.py
   ```
3. **Run Dashboard:**
   Launch the interactive mapping application locally.
   ```bash
   streamlit run streamlit-app/app.py
   ```



## Data Sourcing
Infrastructure data: 
    MetroBus: https://data-metrostl.opendata.arcgis.com/datasets/METROSTL::currentsystem-registered/explore?layer=4&location=38.636254%2C-90.252426%2C11
    MetroLink: https://data-metrostl.opendata.arcgis.com/datasets/METROSTL::currentsystem-registered/explore?layer=3&location=38.646980%2C-90.268905%2C10
    StationsBus: https://data-metrostl.opendata.arcgis.com/datasets/METROSTL::currentsystem-registered/explore?layer=2&location=38.646980%2C-90.268905%2C10
    StationsMetroLink: https://data-metrostl.opendata.arcgis.com/datasets/METROSTL::currentsystem-registered/explore?layer=1&location=38.646980%2C-90.268905%2C10

Public Saftey Data:
    FireProtection (STLC): https://data-stlcogis.opendata.arcgis.com/datasets/fire-districts/explore?location=38.659442%2C-90.330583%2C11&showTable=true
    FireStation (STLC) [not an immediate data source]: https://wiki.radioreference.com/index.php/St._Louis_County_(MO)_Fire/EMS_Stations
    FireStations (STL): https://hub.planstl.com/datasets/fire-stations-1/explore?location=38.638327%2C-90.235081%2C11
    PolicePrecinct (all): https://data.stlouisco.com/datasets/stlcogis::alldepartments-2024/explore?location=38.640936%2C-90.416034%2C10
    
GeoData:
    TractGIS: https://catalog.data.gov/dataset/tiger-line-shapefile-2021-state-missouri-census-tracts/resource/7e9d9218-f9ab-4866-b090-b470de3b987a
    MunicipalGIS: https://data-stlcogis.opendata.arcgis.com/datasets/municipal-boundaries-4/explore?location=38.639600%2C-90.427400%2C10

Business:
    stl_innovation_geo.csv: Manual input data gathered online

Municipal Finance:
    municipal_governance_merged.csv: Manual input data derived from Better Together 2017 data found at https://www.bettertogetherstl.com/wp-content/uploads/2015/12/General-Administration-Report-Study-3-Final.pdf
    muni_finances_merged.csv: Manual input data derived from Better Together 2017 data found at https://www.bettertogetherstl.com/wp-content/uploads/2015/12/Better-Together-General-Administration-Report-2-FINAL-.pdf
    fisc_data.csv: https://www.lincolninst.edu/app/uploads/2026/01/FiSC-Full-Dataset-2023-Update.xlsx
